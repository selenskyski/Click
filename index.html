<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Click</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background-color: #111;
      color: #fff;
      font-family: 'Arial', sans-serif;
      overflow: hidden;
    }

    .counter {
      position: absolute;
      top: 10px;
      left: 15px;
      font-size: 1.2rem;
      background: rgba(255, 255, 255, 0.1);
      padding: 6px 12px;
      border-radius: 6px;
    }

    .currency {
      position: absolute;
      top: 10px;
      left: 150px;
      font-size: 1.2rem;
      background: rgba(255, 255, 255, 0.1);
      padding: 6px 12px;
      border-radius: 6px;
    }

    .menu-button {
      position: absolute;
      top: 10px;
      right: 15px;
      background: #333;
      padding: 6px 12px;
      border: none;
      color: #fff;
      font-size: 1rem;
      border-radius: 6px;
      cursor: pointer;
    }

    .menu {
      position: absolute;
      top: 50px;
      right: 15px;
      background: #222;
      padding: 10px;
      border-radius: 8px;
      display: none;
      flex-direction: column;
      gap: 8px;
    }

    .menu button {
      background: #444;
      color: white;
      border: none;
      padding: 8px;
      border-radius: 5px;
      cursor: pointer;
    }

    .click-box {
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 8vw;
      cursor: pointer;
      text-align: center;
      user-select: none;
      transition: color 0.2s ease;
    }

    .thank-you {
      color: #00ff88;
    }

    .event-log {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255,255,255,0.05);
      padding: 10px 20px;
      border-radius: 6px;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>

  <div class="counter">Clicks: <span id="clickCount">0</span></div>
  <div class="currency">Currency: $<span id="currencyCount">0</span></div>
  <button class="menu-button" onclick="toggleMenu()">☰</button>
  <div class="menu" id="menu">
    <button onclick="resetClicks()">Reset Counter</button>
    <button onclick="saveToDatabase()">Save to Database</button>
    <button onclick="buyUpgrade()">Buy Upgrade</button>
  </div>
  <div class="click-box" id="clickBox">Click</div>
  <div class="event-log" id="eventLog">Waiting for events...</div>

  <script>
    let count = parseInt(localStorage.getItem("clickCount")) || 0;
    let currency = parseInt(localStorage.getItem("currency")) || 0;
    let isThankYou = false;
    let clickPower = parseInt(localStorage.getItem("clickPower")) || 1;

    const counterEl = document.getElementById("clickCount");
    const currencyEl = document.getElementById("currencyCount");
    const clickBox = document.getElementById("clickBox");
    const menu = document.getElementById("menu");
    const eventLog = document.getElementById("eventLog");

    counterEl.textContent = count;
    currencyEl.textContent = currency;

    function handleClick() {
      count += clickPower;
      currency += Math.floor(clickPower * 0.5);
      updateDisplay();
      saveState();

      isThankYou = !isThankYou;
      clickBox.textContent = isThankYou ? "Thank you" : "Click";
      clickBox.classList.toggle("thank-you", isThankYou);
    }

    function toggleMenu() {
      menu.style.display = menu.style.display === "flex" ? "none" : "flex";
    }

    function resetClicks() {
      count = 0;
      currency = 0;
      clickPower = 1;
      saveState();
      updateDisplay();
    }

    function saveToDatabase() {
      alert("Pretending to save to the cloud... (still fake 😎)");
    }

    function buyUpgrade() {
      const upgradeCost = (clickPower + 1) * 10;
      if (currency >= upgradeCost) {
        currency -= upgradeCost;
        clickPower += 1;
        saveState();
        updateDisplay();
        alert(`Upgrade bought! Clicks now worth ${clickPower} each.`);
      } else {
        alert(`Not enough currency! You need $${upgradeCost}.`);
      }
    }

    function updateDisplay() {
      counterEl.textContent = count;
      currencyEl.textContent = currency;
    }

    function saveState() {
      localStorage.setItem("clickCount", count);
      localStorage.setItem("clickPower", clickPower);
      localStorage.setItem("currency", currency);
    }

    function triggerRandomEvent() {
      const events = [
        {
          name: "Tax Takers",
          effect: () => {
            const stolen = Math.floor(count * 0.25);
            count = Math.max(0, count - stolen);
            eventLog.textContent = `💸 Tax Takers stole ${stolen} clicks!`;
          }
        },
        {
          name: "Bonus Round!",
          effect: () => {
            const bonus = Math.floor(Math.random() * 15 + 10);
            count += bonus;
            currency += bonus;
            eventLog.textContent = `🎉 Bonus! You got ${bonus} extra clicks and cash!`;
          }
        },
        {
          name: "System Glitch",
          effect: () => {
            const lost = Math.floor(clickPower * 2);
            clickPower = Math.max(1, clickPower - 1);
            eventLog.textContent = `⚠️ Glitch! Click power reduced temporarily.`;
          }
        }
      ];

      const chosen = events[Math.floor(Math.random() * events.length)];
      chosen.effect();
      updateDisplay();
      saveState();

      // Reset event log after 5 seconds
      setTimeout(() => {
        eventLog.textContent = "Waiting for events...";
      }, 5000);
    }

    // Event timer
    setInterval(triggerRandomEvent, 70000); // every 70 seconds

    // Add Market to menu
    menu.innerHTML = `
      <button onclick="resetClicks()">Reset Counter</button>
      <button onclick="saveToDatabase()">Save to Database</button>
      <button onclick="buyUpgrade()">Buy Upgrade</button>
      <button onclick="openMarket()">Market</button>
    `;

    function openMarket() {
      const upgrades = [
        { name: "Click Boost", cost: 50, effect: () => clickPower += 1 },
        { name: "Event Shield", cost: 100, effect: () => console.log("Shield activated!") }, // Placeholder effect
        { name: "Auto-Clicker", cost: 200, effect: () => startAutoClick() } // Placeholder function
      ];

      let message = "Market:\n";
      upgrades.forEach((upgrade, index) => {
        message += `${index + 1}. ${upgrade.name} - $${upgrade.cost}\n`;
      });
      message += "Enter upgrade number (1-3) or 0 to exit.";
      let choice = prompt(message);

      choice = parseInt(choice);
      if (choice >= 1 && choice <= upgrades.length) {
        const upgrade = upgrades[choice - 1];
        if (currency >= upgrade.cost) {
          currency -= upgrade.cost;
          upgrade.effect();
          updateDisplay();
          saveState();
          alert(`${upgrade.name} purchased!`);
        } else {
          alert("Not enough currency!");
        }
      }
    }

    // Placeholder for Auto-Clicker
    function startAutoClick() {
      setInterval(() => {
        count += 1;
        currency += 0.5;
        updateDisplay();
        saveState();
      }, 10000); // Every 10 seconds
    }

    // Listeners
    clickBox.addEventListener("click", handleClick);
    document.addEventListener("keydown", (e) => {
      if (e.code === "Space" || e.code === "Enter") {
        handleClick();
      }
    });
  </script>

</body>
</html>
